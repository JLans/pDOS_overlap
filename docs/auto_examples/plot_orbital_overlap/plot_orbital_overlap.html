

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Calculating orbital overlap using pdos_overlap &mdash; pdos_overlap 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-dataframe.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Plotting cyrstal orbital overlap population obtained from lobster" href="../plot_overlap_population/plot_overlap_population.html" />
    <link rel="prev" title="Calculating band center using vdos" href="../plot_band_center/plot_band_center.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> pdos_overlap
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../includeme.html">pDOS_overlap</a></li>
</ul>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../pdos_overlap.html">pdos_overlap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vasp_dos.html">vasp_dos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overlap_population.html">overlap_population</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../coordination.html">coordination</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plotting_tools.html">plotting_tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../error_metrics.html">error_metrics</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#band-center-calculation-example">Band center calculation example</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#orbital-overlap-calculation-example">Orbital overlap calculation example</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Calculating orbital overlap using pdos_overlap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#load-doscar-file">Load DOSCAR file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generate-vasp-dos-objects">Generate VASP_DOS objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-adsorbate-and-site-indices-and-initialize-pdos-overlap-object">Get adsorbate and site indices and initialize PDOS_OVERLAP object</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plot-projected-density">Plot projected density</a></li>
<li class="toctree-l4"><a class="reference internal" href="#find-the-optimal-upshift-factor">Find the optimal upshift factor</a></li>
<li class="toctree-l4"><a class="reference internal" href="#identify-bonding-orbitals">Identify bonding orbitals</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plot-energy-overlap">Plot energy overlap</a></li>
<li class="toctree-l4"><a class="reference internal" href="#obtain-projected-overlap">Obtain projected overlap</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plot-the-bonding-populaiton-with-respect-to-the-cc-and-ch-bonds">Plot the bonding populaiton with respect to the CC and CH bonds</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#overlap-population-examples">Overlap population examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#projected-density-examples">Projected density examples</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pdos_overlap</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Examples</a> &raquo;</li>
        
      <li>Calculating orbital overlap using pdos_overlap</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/auto_examples/plot_orbital_overlap/plot_orbital_overlap.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-plot-orbital-overlap-plot-orbital-overlap-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="calculating-orbital-overlap-using-pdos-overlap">
<span id="sphx-glr-auto-examples-plot-orbital-overlap-plot-orbital-overlap-py"></span><h1>Calculating orbital overlap using pdos_overlap<a class="headerlink" href="#calculating-orbital-overlap-using-pdos-overlap" title="Permalink to this headline">¶</a></h1>
<p>This example shows how calculate the overlap of gas phase molecular orbitals with an adsorbate and surface atom.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pdos_overlap.vasp_dos</span> <span class="kn">import</span> <span class="n">VASP_DOS</span>
<span class="kn">from</span> <span class="nn">pdos_overlap</span> <span class="kn">import</span> <span class="n">get_adsorbate_indices</span>
<span class="kn">from</span> <span class="nn">pdos_overlap</span> <span class="kn">import</span> <span class="n">PDOS_OVERLAP</span>
<span class="kn">from</span> <span class="nn">pdos_overlap.overlap_population</span> <span class="kn">import</span> <span class="n">OVERLAP_POPULATION</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Downloads_folder</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/os.path.html#os.path.expanduser" title="os.path.expanduser" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span></a><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span><span class="s1">&#39;Downloads&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="load-doscar-file">
<h2>Load DOSCAR file<a class="headerlink" href="#load-doscar-file" title="Permalink to this headline">¶</a></h2>
<p>First we will, get the example data, load a DOSCAR file and use it to
instantiate a VASP_DOS object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gas</span></a> <span class="o">=</span> <span class="s1">&#39;gases/CO&#39;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">adsorbate</span></a> <span class="o">=</span> <span class="s1">&#39;CO&#39;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">surface</span></a> <span class="o">=</span> <span class="s1">&#39;Pt111&#39;</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.set_printoptions.html#numpy.set_printoptions" title="numpy.set_printoptions" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span></a><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="c1">#These files are too large to store in the examples directory</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lobster_path</span></a> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users\lansf\Documents\Data\PROBE_PDOS\lobster_files_(N+1)bands&#39;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">GAS_DOSCAR</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lobster_path</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gas</span></a> <span class="o">+</span> <span class="s1">&#39;/DOSCAR.lobster&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">GAS_CONTCAR</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lobster_path</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gas</span></a> <span class="o">+</span> <span class="s1">&#39;/CONTCAR&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ADSORBATE_DOSCAR</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lobster_path</span></a><span class="p">,</span> <span class="s1">&#39;surfaces_noW/&#39;</span><span class="o">+</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">surface</span></a> <span class="o">+</span> <span class="s1">&#39;+&#39;</span>\
                          <span class="o">+</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">adsorbate</span></a> <span class="o">+</span> <span class="s1">&#39;/DOSCAR.lobster&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ADSORBATE_CONTCAR</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lobster_path</span></a><span class="p">,</span> <span class="s1">&#39;surfaces_noW/&#39;</span><span class="o">+</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">surface</span></a> <span class="o">+</span> <span class="s1">&#39;+&#39;</span>\
                          <span class="o">+</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">adsorbate</span></a> <span class="o">+</span> <span class="s1">&#39;/CONTCAR&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="generate-vasp-dos-objects">
<h2>Generate VASP_DOS objects<a class="headerlink" href="#generate-vasp-dos-objects" title="Permalink to this headline">¶</a></h2>
<p>VASP_DOS objects for both the gas (vacuum) and the adsorbate+surface system</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GAS_PDOS</span> <span class="o">=</span> <span class="n">VASP_DOS</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">GAS_DOSCAR</span></a><span class="p">)</span>
<span class="n">REFERENCE_PDOS</span> <span class="o">=</span> <span class="n">VASP_DOS</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ADSORBATE_DOSCAR</span></a><span class="p">)</span>
<span class="c1">#REFERENCE_PDOS.apply_gaussian_filter(10)</span>
</pre></div>
</div>
</div>
<div class="section" id="get-adsorbate-and-site-indices-and-initialize-pdos-overlap-object">
<h2>Get adsorbate and site indices and initialize PDOS_OVERLAP object<a class="headerlink" href="#get-adsorbate-and-site-indices-and-initialize-pdos-overlap-object" title="Permalink to this headline">¶</a></h2>
<p>This method utilizes two VASP_DOS objects, a gas and an adsorption system.
It uses the adosorbtion system (REFERENCE_PDOS) to map gas molecular orbitals
to adsorbate molecular orbitals. It then calculates the adsorption site
atomic orbital energy overlaps with the adsorbate molecular orbital energies.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reference_indices</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">site_indices</span></a> <span class="o">=</span> <span class="n">get_adsorbate_indices</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">GAS_CONTCAR</span></a>\
                                                        <span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ADSORBATE_CONTCAR</span></a><span class="p">)</span>
<span class="c1">#Initialize Coordination object. Repeat is necessary so it doesn&#39;t count itself</span>
<span class="n">CO_overlap</span> <span class="o">=</span> <span class="n">PDOS_OVERLAP</span><span class="p">(</span><span class="n">GAS_PDOS</span><span class="p">,</span> <span class="n">REFERENCE_PDOS</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reference_indices</span></a>\
                          <span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">site_indices</span></a><span class="p">,</span> <span class="n">min_occupation</span><span class="o">=</span><span class="mf">0.9</span>\
                          <span class="p">,</span> <span class="n">upshift</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">energy_weight</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="plot-projected-density">
<h2>Plot projected density<a class="headerlink" href="#plot-projected-density" title="Permalink to this headline">¶</a></h2>
<p>We plot the projected density of the gas, adsorbate, and adsorption site.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CO_overlap</span><span class="o">.</span><span class="n">plot_projected_density</span><span class="p">(</span><span class="n">figure_directory</span><span class="o">=</span><span class="s1">&#39;print&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_orbital_overlap_001.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_orbital_overlap_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>C:\Users\lansf\Box Sync\Synced_Files\Coding\Python\Github\pDOS_overlap\pdos_overlap\pdos_overlap.py:971: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
</pre></div>
</div>
</div>
<div class="section" id="find-the-optimal-upshift-factor">
<h2>Find the optimal upshift factor<a class="headerlink" href="#find-the-optimal-upshift-factor" title="Permalink to this headline">¶</a></h2>
<p>The optimal upshift factor shifts the gas molecular orbital energies to
minimize the sum the orbital scores used in matching gas and adsorbate orbitals.
This has the effect of increasing certainty and roughly corresponds to the
average shift in molecular orbital energies when a gas adsorbs to the surface</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">optimized_upshift</span> <span class="o">=</span> <span class="n">CO_overlap</span><span class="o">.</span><span class="n">optimize_energy_shift</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>\
                                                     <span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">optimized_upshift</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_orbital_overlap_002.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_orbital_overlap_002.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>C:\Users\lansf\Box Sync\Synced_Files\Coding\Python\Github\pDOS_overlap\pdos_overlap\pdos_overlap.py:833: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
4.5774990494431975
</pre></div>
</div>
</div>
<div class="section" id="identify-bonding-orbitals">
<h2>Identify bonding orbitals<a class="headerlink" href="#identify-bonding-orbitals" title="Permalink to this headline">¶</a></h2>
<p>We calcluate the amount of density for each orbital that is in a bonding region
We can do this both for the gas and for the adsorbate</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#gas</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">COOPCAR_CO</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lobster_path</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gas</span></a> <span class="o">+</span> <span class="s1">&#39;/COOPCAR.lobster&#39;</span><span class="p">)</span>
<span class="n">POP_CO_GAS</span> <span class="o">=</span> <span class="n">OVERLAP_POPULATION</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">COOPCAR_CO</span></a><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bonding_states</span></a> <span class="o">=</span> <span class="n">POP_CO_GAS</span><span class="o">.</span><span class="n">get_bonding_states</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_overlap</span><span class="o">.</span><span class="n">gas_orbital_indices</span></a>\
                                               <span class="p">,</span> <span class="n">CO_overlap</span><span class="o">.</span><span class="n">GAS_PDOS</span><span class="o">.</span><span class="n">get_energies</span><span class="p">()</span>\
                                               <span class="p">,</span> <span class="n">set_antibonding_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gas bonding states&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bonding_states</span></a><span class="p">)</span>

<span class="c1">#adsorbate</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">COOPCAR_CO</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lobster_path</span></a><span class="p">,</span> <span class="s1">&#39;surfaces_noW/&#39;</span><span class="o">+</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">surface</span></a> <span class="o">+</span> <span class="s1">&#39;+&#39;</span>\
                          <span class="o">+</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">adsorbate</span></a> <span class="o">+</span> <span class="s1">&#39;/COOPCAR.lobster&#39;</span><span class="p">)</span>
<span class="n">POP_CO_ADSORBATE</span> <span class="o">=</span> <span class="n">OVERLAP_POPULATION</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">COOPCAR_CO</span></a><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bonding_states</span></a> <span class="o">=</span> <span class="n">POP_CO_ADSORBATE</span><span class="o">.</span><span class="n">get_bonding_states</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_overlap</span><span class="o">.</span><span class="n">adsorbate_orbital_indices</span></a>\
                                               <span class="p">,</span> <span class="n">CO_overlap</span><span class="o">.</span><span class="n">REFERENCE_PDOS</span><span class="o">.</span><span class="n">get_energies</span><span class="p">()</span>\
                                               <span class="p">,</span> <span class="n">set_antibonding_zero</span><span class="o">=</span><span class="kc">True</span>
                                               <span class="p">,</span> <span class="n">emax</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_overlap</span><span class="o">.</span><span class="n">REFERENCE_PDOS</span><span class="o">.</span><span class="n">e_fermi</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Adsorbate bonding states&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bonding_states</span></a><span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bonding_states</span></a> <span class="o">=</span> <span class="n">POP_CO_ADSORBATE</span><span class="o">.</span><span class="n">get_bonding_states</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_overlap</span><span class="o">.</span><span class="n">adsorbate_orbital_indices</span></a>
                                               <span class="p">,</span> <span class="n">CO_overlap</span><span class="o">.</span><span class="n">REFERENCE_PDOS</span><span class="o">.</span><span class="n">get_energies</span><span class="p">()</span>
                                               <span class="p">,</span> <span class="n">interactions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                                               <span class="p">,</span> <span class="n">set_antibonding_zero</span><span class="o">=</span><span class="kc">False</span>
                                               <span class="p">,</span> <span class="n">emax</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_overlap</span><span class="o">.</span><span class="n">REFERENCE_PDOS</span><span class="o">.</span><span class="n">e_fermi</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;C-O bonding states&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bonding_states</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_overlap</span><span class="o">.</span><span class="n">adsorbate_band_centers</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_overlap</span><span class="o">.</span><span class="n">adsorbate_occupations</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Gas bonding states
[0.32857503080831574, 0.04984388291942448, 0.4167377170944606, -0.2474084481937029, -0.8939270458071957, -1.4954457021959855, -1.823124440481903]
Adsorbate bonding states
[0.31000739229720375, 0.23427202280494233, 0.08807051817544552, 0.4599271644410861, 0.04355907479835258]
C-O bonding states
[0.3052212147472367, 0.053268855851129136, -0.05700779103685123, 0.3604014118201847, -0.10831114372877033]
[-24.28840422 -10.72510378  -8.0377708   -7.17758304   1.89603313]
[1.99592759 1.52472668 1.71156427 3.23883368 7.53202893]
</pre></div>
</div>
</div>
<div class="section" id="plot-energy-overlap">
<h2>Plot energy overlap<a class="headerlink" href="#plot-energy-overlap" title="Permalink to this headline">¶</a></h2>
<p>We select energy overlap histograms with the adsorbate molecular orbitals
that influence spectra. Gas orbitals 1,2, and 3 interact with the surface.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CO_overlap</span><span class="o">.</span><span class="n">plot_energy_overlap</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">atomic_orbitals</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]</span>
                               <span class="p">,</span> <span class="n">figure_directory</span><span class="o">=</span><span class="s1">&#39;print&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="../../_images/sphx_glr_plot_orbital_overlap_003.png" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_orbital_overlap_003.png" />
</li>
<li><img alt="../../_images/sphx_glr_plot_orbital_overlap_004.png" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_orbital_overlap_004.png" />
</li>
<li><img alt="../../_images/sphx_glr_plot_orbital_overlap_005.png" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_orbital_overlap_005.png" />
</li>
<li><img alt="../../_images/sphx_glr_plot_orbital_overlap_006.png" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_orbital_overlap_006.png" />
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>C:\Users\lansf\Box Sync\Synced_Files\Coding\Python\Github\pDOS_overlap\pdos_overlap\pdos_overlap.py:897: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
</pre></div>
</div>
</div>
<div class="section" id="obtain-projected-overlap">
<h2>Obtain projected overlap<a class="headerlink" href="#obtain-projected-overlap" title="Permalink to this headline">¶</a></h2>
<p>We projected orbital overlap for the C-C bond and C-H bonds in C2H4
We group the CH bonds and ensure to sum for spins as all electrons are paired</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">GAS_OVERLAP</span></a> <span class="o">=</span> <span class="n">POP_CO_GAS</span><span class="o">.</span><span class="n">get_pcoop</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">sum_pcoop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ADSORBATE_OVERLAP</span></a> <span class="o">=</span> <span class="n">POP_CO_ADSORBATE</span><span class="o">.</span><span class="n">get_pcoop</span><span class="p">(</span><span class="n">sum_pcoop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">set_antibonding_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_OVERLAP</span></a> <span class="o">=</span> <span class="n">POP_CO_ADSORBATE</span><span class="o">.</span><span class="n">get_pcoop</span><span class="p">([</span><span class="mi">2</span><span class="p">],</span><span class="n">sum_pcoop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="plot-the-bonding-populaiton-with-respect-to-the-cc-and-ch-bonds">
<h2>Plot the bonding populaiton with respect to the CC and CH bonds<a class="headerlink" href="#plot-the-bonding-populaiton-with-respect-to-the-cc-and-ch-bonds" title="Permalink to this headline">¶</a></h2>
<p>A positive value on the x-axis indicates are greater proportion of states in
in the bond than outside of the bond</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">7.2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">abc</span></a> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;(a)&#39;</span><span class="p">,</span><span class="s1">&#39;(b)&#39;</span><span class="p">,</span><span class="s1">&#39;(c)&#39;</span><span class="p">]</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes_list</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="c1">#plotting function</span>
<span class="k">def</span> <span class="nf">plot_density</span><span class="p">(</span><span class="n">OVERLAP</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span> <span class="n">e_fermi</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes_list</span></a><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">OVERLAP</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes_list</span></a><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">OVERLAP</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">OVERLAP</span><span class="p">)]</span>
             <span class="p">,[</span><span class="n">e_fermi</span><span class="p">,</span> <span class="n">e_fermi</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes_list</span></a><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.90</span><span class="p">,</span><span class="mf">0.96</span><span class="p">,</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">abc</span></a><span class="p">[</span><span class="n">index</span><span class="p">],</span><span class="n">transform</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes_list</span></a><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

<span class="c1">#plot gas density</span>
<span class="n">plot_density</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">GAS_OVERLAP</span></a><span class="p">,</span> <span class="n">POP_CO_GAS</span><span class="o">.</span><span class="n">get_energies</span><span class="p">(),</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">POP_CO_GAS</span><span class="o">.</span><span class="n">e_fermi</span></a><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1">#plot adsorbate density</span>
<span class="n">plot_density</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_OVERLAP</span></a><span class="p">,</span> <span class="n">POP_CO_ADSORBATE</span><span class="o">.</span><span class="n">get_energies</span><span class="p">(),</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">POP_CO_ADSORBATE</span><span class="o">.</span><span class="n">e_fermi</span></a><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1">#plot adsorption-site density</span>
<span class="n">plot_density</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ADSORBATE_OVERLAP</span></a><span class="p">,</span> <span class="n">POP_CO_ADSORBATE</span><span class="o">.</span><span class="n">get_energies</span><span class="p">(),</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">POP_CO_ADSORBATE</span><span class="o">.</span><span class="n">e_fermi</span></a><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;Energy [eV]&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s1">&#39;Overlap density [states/eV]&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_path</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Downloads_folder</span></a><span class="p">,</span><span class="s1">&#39;pccop.jpg&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_tight_layout</span><span class="p">({</span><span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;w_pad&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>C:\Users\lansf\Box Sync\Synced_Files\Coding\Python\Github\pDOS_overlap\examples\plot_orbital_overlap\plot_orbital_overlap.py:167: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  fig.show()
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  8.245 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-orbital-overlap-plot-orbital-overlap-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/a5084ecdc30d9e748f0de694ab0df150/plot_orbital_overlap.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_orbital_overlap.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c984d2a5fb4f45b02cc90e24aeed608e/plot_orbital_overlap.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_orbital_overlap.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../plot_overlap_population/plot_overlap_population.html" class="btn btn-neutral float-right" title="Plotting cyrstal orbital overlap population obtained from lobster" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../plot_band_center/plot_band_center.html" class="btn btn-neutral float-left" title="Calculating band center using vdos" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Joshua Lansford

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>