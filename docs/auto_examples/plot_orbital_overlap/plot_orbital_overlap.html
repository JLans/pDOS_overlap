

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Calculating orbital overlap using pdos_overlap &mdash; pdos_overlap 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-dataframe.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Plotting cyrstal orbital overlap population obtained from lobster" href="../plot_overlap_population/plot_overlap_population.html" />
    <link rel="prev" title="Calculating band center using vdos" href="../plot_band_center/plot_band_center.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> pdos_overlap
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../includeme.html">pdos_overlap</a></li>
</ul>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../pdos_overlap.html">pdos_overlap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vasp_dos.html">vasp_dos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overlap_population.html">overlap_population</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../coordination.html">coordination</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plotting_tools.html">plotting_tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../error_metrics.html">error_metrics</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#band-center-calculation-example">Band center calculation example</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#orbital-overlap-calculation-example">Orbital overlap calculation example</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Calculating orbital overlap using pdos_overlap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#load-doscar-file">Load DOSCAR file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generate-vasp-dos-objects">Generate VASP_DOS objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-adsorbate-and-site-indices-and-initialize-pdos-overlap-object">Get adsorbate and site indices and initialize PDOS_OVERLAP object</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plot-projected-density">Plot projected density</a></li>
<li class="toctree-l4"><a class="reference internal" href="#find-the-optimal-upshift-factor">Find the optimal upshift factor</a></li>
<li class="toctree-l4"><a class="reference internal" href="#print-orbital-co-overlap-attributes">Print orbital CO_overlap attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#identify-bonding-orbitals">Identify bonding orbitals</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plot-energy-overlap">Plot energy overlap</a></li>
<li class="toctree-l4"><a class="reference internal" href="#print-orbital-interactions">Print orbital interactions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#overlap-population-examples">Overlap population examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#projected-density-examples">Projected density examples</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pdos_overlap</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Examples</a> &raquo;</li>
        
      <li>Calculating orbital overlap using pdos_overlap</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/auto_examples/plot_orbital_overlap/plot_orbital_overlap.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-plot-orbital-overlap-plot-orbital-overlap-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="calculating-orbital-overlap-using-pdos-overlap">
<span id="sphx-glr-auto-examples-plot-orbital-overlap-plot-orbital-overlap-py"></span><h1>Calculating orbital overlap using pdos_overlap<a class="headerlink" href="#calculating-orbital-overlap-using-pdos-overlap" title="Permalink to this headline">¶</a></h1>
<p>This example shows how calculate the overlap of gas phase molecular orbitals with an adsorbate and surface atom.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pdos_overlap.vasp_dos</span> <span class="kn">import</span> <span class="n">VASP_DOS</span>
<span class="kn">from</span> <span class="nn">pdos_overlap.plotting_tools</span> <span class="kn">import</span> <span class="n">set_figure_settings</span>
<span class="kn">from</span> <span class="nn">pdos_overlap</span> <span class="kn">import</span> <span class="n">get_adsorbate_indices</span>
<span class="kn">from</span> <span class="nn">pdos_overlap</span> <span class="kn">import</span> <span class="n">PDOS_OVERLAP</span>
<span class="kn">from</span> <span class="nn">pdos_overlap.coordination</span> <span class="kn">import</span> <span class="n">get_geometric_data</span>
<span class="kn">from</span> <span class="nn">pdos_overlap.overlap_population</span> <span class="kn">import</span> <span class="n">OVERLAP_POPULATION</span>
</pre></div>
</div>
<div class="section" id="load-doscar-file">
<h2>Load DOSCAR file<a class="headerlink" href="#load-doscar-file" title="Permalink to this headline">¶</a></h2>
<p>First we will, get the example data, load a DOSCAR file and use it to
instantiate a VASP_DOS object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gas</span></a> <span class="o">=</span> <span class="s1">&#39;CO&#39;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">adsorbate</span></a> <span class="o">=</span> <span class="s1">&#39;CO&#39;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">surface</span></a> <span class="o">=</span> <span class="s1">&#39;Pt111&#39;</span>
<span class="n">set_figure_settings</span><span class="p">(</span><span class="s1">&#39;paper&#39;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.set_printoptions.html#numpy.set_printoptions" title="numpy.set_printoptions" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span></a><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="c1">#These files are too large to store in the examples directory</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lobster_path</span></a> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users\lansf\Documents\Data\PROBE_PDOS\lobster_files&#39;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">GAS_DOSCAR</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lobster_path</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gas</span></a> <span class="o">+</span> <span class="s1">&#39;/DOSCAR.lobster&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">GAS_CONTCAR</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lobster_path</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gas</span></a> <span class="o">+</span> <span class="s1">&#39;/CONTCAR&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ADSORBATE_DOSCAR</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lobster_path</span></a><span class="p">,</span> <span class="s1">&#39;surfaces_noW/&#39;</span><span class="o">+</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">surface</span></a> <span class="o">+</span> <span class="s1">&#39;+&#39;</span>\
                          <span class="o">+</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">adsorbate</span></a> <span class="o">+</span> <span class="s1">&#39;/DOSCAR.lobster&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ADSORBATE_CONTCAR</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lobster_path</span></a><span class="p">,</span> <span class="s1">&#39;surfaces_noW/&#39;</span><span class="o">+</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">surface</span></a> <span class="o">+</span> <span class="s1">&#39;+&#39;</span>\
                          <span class="o">+</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">adsorbate</span></a> <span class="o">+</span> <span class="s1">&#39;/CONTCAR&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="generate-vasp-dos-objects">
<h2>Generate VASP_DOS objects<a class="headerlink" href="#generate-vasp-dos-objects" title="Permalink to this headline">¶</a></h2>
<p>VASP_DOS objects for both the gas (vacuum) and the adsorbate+surface system</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GAS_PDOS</span> <span class="o">=</span> <span class="n">VASP_DOS</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">GAS_DOSCAR</span></a><span class="p">)</span>
<span class="n">REFERENCE_PDOS</span> <span class="o">=</span> <span class="n">VASP_DOS</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ADSORBATE_DOSCAR</span></a><span class="p">)</span>
<span class="c1">#REFERENCE_PDOS.apply_gaussian_filter(10)</span>
</pre></div>
</div>
</div>
<div class="section" id="get-adsorbate-and-site-indices-and-initialize-pdos-overlap-object">
<h2>Get adsorbate and site indices and initialize PDOS_OVERLAP object<a class="headerlink" href="#get-adsorbate-and-site-indices-and-initialize-pdos-overlap-object" title="Permalink to this headline">¶</a></h2>
<p>This method utilizes two VASP_DOS objects, a gas and an adsorption system.
It uses the adosorbtion system (REFERENCE_PDOS) to map gas molecular orbitals
to adsorbate molecular orbitals. It then calculates the adsorption site
atomic orbital energy overlaps with the adsorbate molecular orbital energies.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reference_indices</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">site_indices</span></a> <span class="o">=</span> <span class="n">get_adsorbate_indices</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">GAS_CONTCAR</span></a>\
                                                        <span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ADSORBATE_CONTCAR</span></a><span class="p">)</span>
<span class="c1">#Initialize Coordination object. Repeat is necessary so it doesn&#39;t count itself</span>
<span class="n">CO_overlap</span> <span class="o">=</span> <span class="n">PDOS_OVERLAP</span><span class="p">(</span><span class="n">GAS_PDOS</span><span class="p">,</span> <span class="n">REFERENCE_PDOS</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reference_indices</span></a>\
                          <span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">site_indices</span></a><span class="p">,</span> <span class="n">min_occupation</span><span class="o">=</span><span class="mf">1.5</span>\
                          <span class="p">,</span> <span class="n">upshift</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">energy_weight</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="plot-projected-density">
<h2>Plot projected density<a class="headerlink" href="#plot-projected-density" title="Permalink to this headline">¶</a></h2>
<p>We plot the projected density of the gas, adsorbate, and adsorption site.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CO_overlap</span><span class="o">.</span><span class="n">plot_projected_density</span><span class="p">()</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="../../_images/sphx_glr_plot_orbital_overlap_001.png" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_orbital_overlap_001.png" />
</li>
<li><img alt="../../_images/sphx_glr_plot_orbital_overlap_002.png" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_orbital_overlap_002.png" />
</li>
<li><img alt="../../_images/sphx_glr_plot_orbital_overlap_003.png" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_orbital_overlap_003.png" />
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>C:\Users\lansf\Box Sync\Synced_Files\Coding\Python\Github\pdos_overlap\pdos_overlap\pdos_overlap.py:928: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
C:\Users\lansf\Box Sync\Synced_Files\Coding\Python\Github\pdos_overlap\pdos_overlap\pdos_overlap.py:928: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
C:\Users\lansf\Box Sync\Synced_Files\Coding\Python\Github\pdos_overlap\pdos_overlap\pdos_overlap.py:928: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
</pre></div>
</div>
</div>
<div class="section" id="find-the-optimal-upshift-factor">
<h2>Find the optimal upshift factor<a class="headerlink" href="#find-the-optimal-upshift-factor" title="Permalink to this headline">¶</a></h2>
<p>The optimal upshift factor shifts the gas molecular orbital energies to
minimize the sum the orbital scores used in matching gas and adsorbate orbitals.
This has the effect of increasing certainty and roughly corresponds to the
average shift in molecular orbital energies when a gas adsorbs to the surface</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">optimized_upshift</span> <span class="o">=</span> <span class="n">CO_overlap</span><span class="o">.</span><span class="n">optimize_energy_shift</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>\
                                                     <span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">optimized_upshift</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_orbital_overlap_004.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_orbital_overlap_004.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>C:\Users\lansf\Box Sync\Synced_Files\Coding\Python\Github\pdos_overlap\pdos_overlap\pdos_overlap.py:833: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
4.633515527006275
</pre></div>
</div>
</div>
<div class="section" id="print-orbital-co-overlap-attributes">
<h2>Print orbital CO_overlap attributes<a class="headerlink" href="#print-orbital-co-overlap-attributes" title="Permalink to this headline">¶</a></h2>
<p>Differences in features are used in computing orbital scores.
Scores are used to map gas molecular orbitals ot adsorbate molecular orbitals.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Print molecular gas and adsorbate orbital features, respectively.&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_overlap</span><span class="o">.</span><span class="n">gas_features</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_overlap</span><span class="o">.</span><span class="n">adsorbate_features</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;#####################################################################&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Orbital matching scores&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_overlap</span><span class="o">.</span><span class="n">orbital_scores</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;#####################################################################&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gas to adsorbate indices and band centers&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_overlap</span><span class="o">.</span><span class="n">gas_2_adsorbate</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Print molecular gas and adsorbate orbital features, respectively.
[[-24.572761     0.76973977   0.           0.23026023   0.        ]
 [ -9.40116069   0.34039071   0.           0.65960929   0.        ]
 [ -7.00016252   0.           0.5          0.           0.5       ]
 [ -4.3997598    0.57635593   0.           0.42364407   0.        ]
 [  2.49523907   0.           0.5          0.           0.5       ]
 [  4.48993915   0.31496024   0.           0.68503976   0.        ]]
[[-2.42885395e+01  7.71587368e-01  0.00000000e+00  2.28412632e-01  0.00000000e+00]
 [-1.07252894e+01  5.51646020e-01  0.00000000e+00  4.48353980e-01  0.00000000e+00]
 [-8.03924343e+00  1.99964346e-01  1.31751621e-02  7.74154675e-01  1.27058169e-02]
 [-7.17760072e+00  1.45379522e-03  4.98517955e-01  4.10139007e-03  4.95926860e-01]
 [ 1.32163269e+00  1.70036682e-01  3.13169406e-01  2.02246382e-01  3.14547530e-01]]
#####################################################################
Orbital matching scores
[[9.98821315e-01 3.18139230e-02 1.54515662e-04 6.57973879e-07 1.31502660e-06]
 [8.72881818e-08 3.98306727e-01 6.46109845e-01 1.20633223e-05 1.56774111e-05]
 [2.26863523e-10 1.28222360e-03 1.24310723e-03 9.98131460e-01 1.17705281e-02]
 [4.37703127e-08 1.92434945e-01 4.14599056e-02 5.11315803e-06 2.37924745e-03]
 [2.86644369e-09 1.09649207e-04 1.74243020e-04 1.81885518e-01 4.26499281e-01]
 [1.30053008e-07 1.23785568e-02 8.07785945e-02 2.83137908e-06 1.15381451e-02]]
#####################################################################
Gas to adsorbate indices and band centers
[[  0.           0.         -29.20627653 -24.28853946]
 [  1.           2.         -14.03467621  -8.03776411]
 [  2.           3.         -11.63367805  -7.17753449]
 [  3.           1.          -9.03327532 -10.72528938]
 [  4.           4.          -2.13827646   1.31587258]
 [  5.           2.          -0.14357638  -8.03776411]]
</pre></div>
</div>
</div>
<div class="section" id="identify-bonding-orbitals">
<h2>Identify bonding orbitals<a class="headerlink" href="#identify-bonding-orbitals" title="Permalink to this headline">¶</a></h2>
<p>We calcluate the amount of density for each orbital that is in a bonding region
We can do this both for the gas and for the adsorbate</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#gas</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">COOPCAR_CO</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lobster_path</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gas</span></a> <span class="o">+</span> <span class="s1">&#39;/COOPCAR.lobster&#39;</span><span class="p">)</span>
<span class="n">POP_CO</span> <span class="o">=</span> <span class="n">OVERLAP_POPULATION</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">COOPCAR_CO</span></a><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bonding_states</span></a> <span class="o">=</span> <span class="n">POP_CO</span><span class="o">.</span><span class="n">get_bonding_states</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_overlap</span><span class="o">.</span><span class="n">gas_orbital_indices</span></a>\
                                               <span class="p">,</span> <span class="n">CO_overlap</span><span class="o">.</span><span class="n">GAS_PDOS</span><span class="o">.</span><span class="n">get_energies</span><span class="p">()</span>\
                                               <span class="p">,</span> <span class="n">set_antibonding_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gas bonding states&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bonding_states</span></a><span class="p">)</span>

<span class="c1">#adsorbate</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">COOPCAR_CO</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lobster_path</span></a><span class="p">,</span> <span class="s1">&#39;surfaces_noW/&#39;</span><span class="o">+</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">surface</span></a> <span class="o">+</span> <span class="s1">&#39;+&#39;</span>\
                          <span class="o">+</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">adsorbate</span></a> <span class="o">+</span> <span class="s1">&#39;/COOPCAR.lobster&#39;</span><span class="p">)</span>
<span class="n">POP_CO</span> <span class="o">=</span> <span class="n">OVERLAP_POPULATION</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">COOPCAR_CO</span></a><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bonding_states</span></a> <span class="o">=</span> <span class="n">POP_CO</span><span class="o">.</span><span class="n">get_bonding_states</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_overlap</span><span class="o">.</span><span class="n">adsorbate_orbital_indices</span></a>\
                                               <span class="p">,</span> <span class="n">CO_overlap</span><span class="o">.</span><span class="n">REFERENCE_PDOS</span><span class="o">.</span><span class="n">get_energies</span><span class="p">()</span>\
                                               <span class="p">,</span> <span class="n">set_antibonding_zero</span><span class="o">=</span><span class="kc">True</span>
                                               <span class="p">,</span> <span class="n">emax</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_overlap</span><span class="o">.</span><span class="n">REFERENCE_PDOS</span><span class="o">.</span><span class="n">e_fermi</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Adsorbate bonding states&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bonding_states</span></a><span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bonding_states</span></a> <span class="o">=</span> <span class="n">POP_CO</span><span class="o">.</span><span class="n">get_bonding_states</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_overlap</span><span class="o">.</span><span class="n">adsorbate_orbital_indices</span></a>
                                               <span class="p">,</span> <span class="n">CO_overlap</span><span class="o">.</span><span class="n">REFERENCE_PDOS</span><span class="o">.</span><span class="n">get_energies</span><span class="p">()</span>
                                               <span class="p">,</span> <span class="n">interactions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                                               <span class="p">,</span> <span class="n">set_antibonding_zero</span><span class="o">=</span><span class="kc">True</span>
                                               <span class="p">,</span> <span class="n">emax</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_overlap</span><span class="o">.</span><span class="n">REFERENCE_PDOS</span><span class="o">.</span><span class="n">e_fermi</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;C-O bonding states&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bonding_states</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Gas bonding states
[0.33390889559640663, 0.05000879480760805, 0.4167793652668387, 0.0, 0.0, 0.0]
Adsorbate bonding states
[0.3395840142537034, 0.23824242669904108, 0.08501356326038817, 0.4627388710479913, 0.045636385827251436]
C-O bonding states
[0.33149060940360775, 0.05483787219978331, 0.003232793522598007, 0.36246791365153325, 0.02166628058368548]
</pre></div>
</div>
</div>
<div class="section" id="plot-energy-overlap">
<h2>Plot energy overlap<a class="headerlink" href="#plot-energy-overlap" title="Permalink to this headline">¶</a></h2>
<p>We select energy overlap histograms with the adsorbate molecular orbitals
that influence spectra. Gas orbitals 1,2, and 3 interact with the surface.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gas_indices</span></a> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">if</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_overlap</span><span class="o">.</span><span class="n">gas_2_adsorbate</span></a><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">adsorbate_indices</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CO_overlap</span><span class="o">.</span><span class="n">gas_2_adsorbate</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gas_indices</span></a><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)]</span>
<span class="n">CO_overlap</span><span class="o">.</span><span class="n">plot_energy_overlap</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">atomic_orbitals</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="../../_images/sphx_glr_plot_orbital_overlap_005.png" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_orbital_overlap_005.png" />
</li>
<li><img alt="../../_images/sphx_glr_plot_orbital_overlap_006.png" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_orbital_overlap_006.png" />
</li>
<li><img alt="../../_images/sphx_glr_plot_orbital_overlap_007.png" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_orbital_overlap_007.png" />
</li>
<li><img alt="../../_images/sphx_glr_plot_orbital_overlap_008.png" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_orbital_overlap_008.png" />
</li>
<li><img alt="../../_images/sphx_glr_plot_orbital_overlap_009.png" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_orbital_overlap_009.png" />
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>C:\Users\lansf\Box Sync\Synced_Files\Coding\Python\Github\pdos_overlap\pdos_overlap\pdos_overlap.py:873: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
</pre></div>
</div>
</div>
<div class="section" id="print-orbital-interactions">
<h2>Print orbital interactions<a class="headerlink" href="#print-orbital-interactions" title="Permalink to this headline">¶</a></h2>
<p>Plot orbital interaction of the first gas molecular orbital with a surface
s, pz, and dz2 orbitals. These are identified from first figure above</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">example_path</span></a> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users\lansf\Documents\Data\PROBE_PDOS\vasp_dos_files&#39;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nano</span></a> <span class="o">=</span> <span class="s1">&#39;Pt44&#39;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nano_DOSCAR</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">example_path</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nano</span></a> <span class="o">+</span> <span class="s1">&#39;/DOSCAR&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nano_CONTCAR</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">example_path</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nano</span></a> <span class="o">+</span> <span class="s1">&#39;/CONTCAR&#39;</span><span class="p">)</span>
<span class="c1">#obtain atom indices and atom type as &#39;surface&#39; or &#39;bulk&#39;</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nano_indices</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">GCNs</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">atom_types</span></a> <span class="o">=</span> <span class="n">get_geometric_data</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nano_CONTCAR</span></a><span class="p">)</span>
<span class="c1">#initialize a PDOS object for the nanoparticle</span>
<span class="n">nano_PDOS</span> <span class="o">=</span> <span class="n">VASP_DOS</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nano_DOSCAR</span></a><span class="p">)</span>
<span class="c1">#calculate orbital interactions</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">BULK_DOSCAR</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">example_path</span></a><span class="p">,</span><span class="s1">&#39;Pt_nano/Pt147/DOSCAR&#39;</span><span class="p">)</span>
<span class="c1"># VASP_DOS objects for both the gas (vacuum) and the adsorbate+surface system</span>
<span class="n">GAS_PDOS</span> <span class="o">=</span> <span class="n">VASP_DOS</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">GAS_DOSCAR</span></a><span class="p">)</span>
<span class="n">REFERENCE_PDOS</span> <span class="o">=</span> <span class="n">VASP_DOS</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ADSORBATE_DOSCAR</span></a><span class="p">)</span>
<span class="n">BULK_PDOS</span> <span class="o">=</span> <span class="n">VASP_DOS</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">BULK_DOSCAR</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Interactions with 4sigma orbital&#39;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orbital_interaction</span></a> <span class="o">=</span> <span class="n">CO_overlap</span><span class="o">.</span><span class="n">get_orbital_interaction</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gas_indices</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
                    <span class="p">,</span> <span class="n">nano_PDOS</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nano_indices</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">atom_types</span></a><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;surface&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>\
                         <span class="p">,</span> <span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;dz2&#39;</span><span class="p">],</span> <span class="n">BULK_PDOS</span><span class="p">,</span> <span class="n">bulk_atom</span><span class="o">=</span><span class="mi">43</span>\
                             <span class="p">,</span> <span class="n">sum_interaction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sum_spin</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orbital_interaction</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Interactions with 1pi orbital&#39;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orbital_interaction</span></a> <span class="o">=</span> <span class="n">CO_overlap</span><span class="o">.</span><span class="n">get_orbital_interaction</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gas_indices</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span>\
                    <span class="p">,</span> <span class="n">nano_PDOS</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nano_indices</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">atom_types</span></a><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;surface&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>\
                         <span class="p">,</span> <span class="p">[</span><span class="s1">&#39;dyz&#39;</span><span class="p">,</span><span class="s1">&#39;dxz&#39;</span><span class="p">],</span> <span class="n">BULK_PDOS</span><span class="p">,</span> <span class="n">bulk_atom</span><span class="o">=</span><span class="mi">43</span>\
                             <span class="p">,</span> <span class="n">sum_interaction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sum_spin</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orbital_interaction</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Interactions with 5sigma orbital&#39;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orbital_interaction</span></a> <span class="o">=</span> <span class="n">CO_overlap</span><span class="o">.</span><span class="n">get_orbital_interaction</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gas_indices</span></a><span class="p">[</span><span class="mi">2</span><span class="p">]</span>\
                    <span class="p">,</span> <span class="n">nano_PDOS</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nano_indices</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">atom_types</span></a><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;surface&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>\
                         <span class="p">,</span> <span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;dz2&#39;</span><span class="p">],</span> <span class="n">BULK_PDOS</span><span class="p">,</span> <span class="n">bulk_atom</span><span class="o">=</span><span class="mi">43</span>\
                             <span class="p">,</span> <span class="n">sum_interaction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sum_spin</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orbital_interaction</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Interactions with 4sigma orbital
[-0.31447143 -0.19597969]
Interactions with 1pi orbital
[-0.66906153 -0.39438149]
Interactions with 5sigma orbital
[-0.46112906 -0.21846186]
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  29.441 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-orbital-overlap-plot-orbital-overlap-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/a5084ecdc30d9e748f0de694ab0df150/plot_orbital_overlap.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_orbital_overlap.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c984d2a5fb4f45b02cc90e24aeed608e/plot_orbital_overlap.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_orbital_overlap.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../plot_overlap_population/plot_overlap_population.html" class="btn btn-neutral float-right" title="Plotting cyrstal orbital overlap population obtained from lobster" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../plot_band_center/plot_band_center.html" class="btn btn-neutral float-left" title="Calculating band center using vdos" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Joshua Lansford

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>